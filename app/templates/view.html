{% comment %}
Copyright 2010 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
{% endcomment %}

{% load i18n %}
{% extends "base.html" %}
{% block title-extra %}
  {{person.first_name|escape}} {{person.last_name|escape}} -
{% endblock %}
{% block head-extra %}
<script type="text/javascript">
function set_display(id_or_elem, hide) {
  var hide_text = hide ? 'none' : '';
  if (typeof(id_or_elem) == 'string') {
    document.getElementById(id_or_elem).style.display = hide_text;
  } else {
    id_or_elem.style.display = hide_text;
  }
}

function hide_unhide_note_contents(note_contents_id) {
  var note = document.getElementById(note_contents_id + '-contents');
  var hidden = note.style.display == 'none';
  set_display(note, !hidden);
  set_display('reveal-note', hidden);
  set_display('hide-note', !hidden);
  set_display(note_contents_id + '-mark-not-spam', !hidden);
}
</script>
{% endblock %}
{% block content %}
{% if not standalone %}
  {% include "map.html" %}
{% endif %}
<form method="post" action="/view">
  {{env.subdomain_field_html}}
  <input type="hidden" name="id" id="person_record_id" value="{{person.record_id|escape}}">
  <input type="hidden" name="query" value="{{params.query|escape}}">
  <table class="view" cellpadding="0" cellspacing="0">
    <tr class="columns">
      <td class="column">
        <table class="person column" cellpadding="0" cellspacing="0">
          <tr>
            <td>
              <h2>{% trans "Identifying information" %}</h2>
              <table class="person display" cellpadding="0" cellspacing="0">
                <tr>
                  <td class="name section">
                    <h3>{% trans "Name" %}</h3>
                    <table class="fields">
                      {% if env.use_family_name and env.family_name_first %}
                        <tr>
                          <td class="label">{% trans "Family name" %}:</td>
                          <td class="field">{{person.last_name|escape}}</td>
                        </tr>
                      {% endif %}
                        <tr>
                          <td class="label">
                            {% if env.use_family_name %}
                              {% trans "Given name" %}:
                            {% else %}
                              {% trans "Name" %}:
                            {% endif %}
                          </td>
                          <td class="field">{{person.first_name|escape}}</td>
                        </tr>
                      {% if env.use_family_name and not env.family_name_first %}
                        <tr>
                          <td class="label">{% trans "Family name" %}:</td>
                          <td class="field">{{person.last_name|escape}}</td>
                        </tr>
                      {% endif %}
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="physical section">
                    <h3>{% trans "Physical characteristics" %}</h3>
                    <table class="fields">
                      <tr>
                        <td class="label">{% trans "Sex" %}:</td>
                        <td class="field">{{person.sex_text|escape}}</td>
                      </tr>
                      {% comment %}
                      Don't show the date of birth in the UI for now.
                      <tr>
                        <td class="label">{% trans "Date of birth" %}:</td>
                        <td class="field">{{person.date_of_birth|escape}}</td>
                      </tr>
                      {% endcomment %}
                      <tr>
                        <td class="label">{% trans "Age" %}:</td>
                        <td class="field">{{person.age|escape}}</td>
                      </tr>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="address section">
                    <h3>{% trans "Home address" %}</h3>
                    <table class="fields">
                      <tr>
                        <td class="label">{% trans "Street name" %}:</td>
                        <td class="field">{{person.home_street|escape}}</td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Neighborhood" %}:</td>
                        <td class="field">{{person.home_neighborhood|escape}}</td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "City" %}:</td>
                        <td class="field">{{person.home_city|escape}}</td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Province or state" %}:</td>
                        <td class="field">{{person.home_state|escape}}</td>
                      </tr>
                      {% if env.use_postal_code %}
                        <tr>
                          <td class="label">{% trans "Postal or zip code" %}:</td>
                          <td class="field">{{person.home_postal_code|escape}}</td>
                        </tr>
                      {% endif %}
                      <tr>
                        <td class="label">{% trans "Home country" %}:</td>
                        <td class="field">{{person.home_country|escape}}</td>
                      </tr>
                    </table>
                  </td>
                </tr>
                {% if person.other %}
                <tr>
                  <td class="other section">
                    <h3>{% trans "Other information" %}</h3>
                    <table class="fields">
                      <tr>
                        <td>
                          <textarea readonly="readonly" cols=40 rows=5
                            >{{person.other|escape}}</textarea>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
                {% endif %}
                {% if person.photo_url %}
                <tr>
                  <td class="photo section">
                    <h3>{% trans "Photo" %}</h3>
                    <table class="fields">
                      <tr>
                        <td>
                          <a href="{{person.photo_url|escape}}">
                            <img src="{{person.photo_url|escape}}"
                                class="photo">
                          </a>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
                {% endif %}
                <tr>
                  <td class="source section">
                    <h3>{% trans "Source of this record" %}</h3>
                    <table class="fields">
                      <tr>
                        <td class="label">{% trans "Author's name" %}:</td>
                        <td class="field">{{person.author_name|escape}}</td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Author's phone number" %}:</td>
                        <td class="field">
                          {% if show_private_info %}
                            {{person.author_phone|escape}}</td>
                          {% else %}
                            {% if person.author_phone %}
                              <a href="{{reveal_url|escape}}">
                                {% trans "(click to reveal)" %}</a>
                            {% endif %}
                          {% endif %}
                        </td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Author's e-mail address" %}:</td>
                        <td class="field">
                          {% if show_private_info %}
                            {{person.author_email|escape}}
                          {% else %}
                            {% if person.author_email %}
                              <a href="{{reveal_url|escape}}">
                                {% trans "(click to reveal)" %}</a>
                            {% endif %}
                          {% endif %}
                        </td>
                      </tr>
                      {% if person.is_clone or person.source_url or person.source_date or person.source_name %}
                      <tr>
                        <td class="label">{% trans "Original URL" %}:</td>
                        <td class="field">
                          <a href="{{person.source_url|escape}}"
                            >{% trans "Link" %}</a>
                        </td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Original posting date" %}:</td>
                        <td class="field">{{person.source_date|date:"Y-m-d H:i \U\T\C"}}</td>
                      </tr>
                      <tr>
                        <td class="label">{% trans "Original site name" %}:</td>
                        <td class="field">{{person.source_name|escape}}</td>
                      </tr>
                      {% endif %}
                    </table>
                    <div class="tracking">
                      ID: {{person.record_id|escape}}
                    </div>
                  </td>
                </tr>
                {% if linked_person_info %}
                <tr>
                  <td class="other section">
                    <h3>{% trans "Possible duplicates" %}</h3>
                    <table class="fields">
                    {% for linked_person in linked_person_info %}
                      <tr>
                        <td>
                          <a href="{{linked_person.view_url|escape}}">
                            {{linked_person.name|escape}}
                          </a>
                          <span class="tracking">
                            ({{linked_person.id|escape}})
                          </span>
                        </td>
                      </tr>
                      {% endfor %}
                      {% if not params.dupe_notes %}
                      <tr>
                        <td><a href="{{dupe_notes_url|escape}}">
                            Show who marked these duplicates
                        </a></td>
                      </tr>
                      {% endif %}
                    </table>
                  </td>
                </tr>
                {% endif %}
              </table>
            </td>
          </tr>
        </table>
        <p>
        {% if params.query or params.first_name or params.last_name %}
          <a href="{{results_url|escape}}">
            {{env.back_chevron|escape}}  {% trans "Back to results list" %}
          </a>
        {% else %}
          <a href="{{env.main_url|escape}}">
            {{env.back_chevron|escape}} {% trans "Back to start" %}
          </a>
        {% endif %}
      </td>
      <td class="column">
      	<input type="button" value="Subscribe to updates about this person" id="subscribe_btn"/>
      	<div id="subscribe_label">Your email:</div>
      	<input type="text" name="email_subscr" value="" id="email_subscr" />
        <div id="upper_need_email_div">You should specify your e-mail to receive updates about this person</div>
      	<input type="submit" value="Subscribe" onclick="return set_notification_trigger();" id="subscribe_submit" />
      	<input type="hidden" value="" name="notify_person" id="notify_person" />
      	<br />
        {% if notes %}
          <h2>{% trans "Status updates for this person" %}</h2>  
          {% for note in notes %}
          {% if params.dupe_notes or not note.linked_person_record_id %}
            {% include "note.html" %}
          {% endif %}
          {% endfor %}
        {% else %}
          <h2>{% trans "No status updates have been posted" %}</h2>
        {% endif %}
        <p>
        {% include "add_note.html" %}
      </td>
    </tr>
  </table>
</form>
<form method="get" action="/delete">
  {{env.subdomain_field_html}}
  <input type="hidden" name="id" value="{{person.record_id|escape}}">
  <input type="submit" value="{% trans "Delete this record" %}">
</form>
{% endblock %}
{% block footer %}{# Explicitly remove Back to Start from bottom of page.#}{% endblock %}
